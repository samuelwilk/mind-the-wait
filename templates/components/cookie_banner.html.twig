{# Cookie Consent Banner - GDPR/CCPA Compliant #}
<div id="cookie-banner" class="hidden fixed bottom-0 left-0 right-0 bg-gray-900 text-white shadow-lg z-50 animate-slide-up">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
        <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4">
            <div class="flex-1">
                <p class="text-sm sm:text-base">
                    <span class="font-semibold">We use cookies to improve your experience.</span>
                    We use Google Analytics to understand how visitors use this site.
                    <a href="{{ path('app_privacy') }}" class="underline hover:text-gray-300">Learn more</a>
                </p>
            </div>
            <div class="flex gap-3 w-full sm:w-auto">
                <button id="reject-cookies"
                        class="flex-1 sm:flex-none px-4 py-2 text-sm font-medium text-gray-300 hover:text-white border border-gray-600 hover:border-gray-500 rounded-lg transition-colors">
                    Decline
                </button>
                <button id="accept-cookies"
                        class="flex-1 sm:flex-none px-4 py-2 text-sm font-medium bg-primary-600 hover:bg-primary-700 text-white rounded-lg transition-colors">
                    Accept
                </button>
            </div>
        </div>
    </div>
</div>

<script>
(function() {
    const banner = document.getElementById('cookie-banner');
    const acceptBtn = document.getElementById('accept-cookies');
    const rejectBtn = document.getElementById('reject-cookies');

    // Check if user has already made a choice
    const consent = localStorage.getItem('analytics-consent');
    if (!consent) {
        // Show banner if no choice has been made
        banner.classList.remove('hidden');
    }

    // Handle accept
    acceptBtn.addEventListener('click', function() {
        localStorage.setItem('analytics-consent', 'granted');
        banner.classList.add('hidden');

        // Update GA4 consent
        if (typeof gtag !== 'undefined') {
            gtag('consent', 'update', {
                'analytics_storage': 'granted'
            });
        }
    });

    // Handle reject
    rejectBtn.addEventListener('click', function() {
        localStorage.setItem('analytics-consent', 'denied');
        banner.classList.add('hidden');

        // Consent remains denied (default state)
    });
})();
</script>

<style>
@keyframes slide-up {
    from {
        transform: translateY(100%);
    }
    to {
        transform: translateY(0);
    }
}

.animate-slide-up {
    animation: slide-up 0.3s ease-out;
}
</style>
